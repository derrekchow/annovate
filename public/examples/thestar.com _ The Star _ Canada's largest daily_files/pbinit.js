window.presbd=window.presbd||{},window.presbd.tools=function(){var d=window,a=d.document,n=d.top.document,t="/js/pbinit.js",y=a.querySelector('script[src$="'+t+'"]').getAttribute("src").replace(t,""),f=0,b="pressboard-ad-sponsorship-tag",w="pressboard-ad-sponsorship-msg";function o(h,g,i){var l={path:i.urlPath,appType:i.appType,sKey:i.sKey,url:h.location.href,mid:i.mid,cid:i.cid,referrer:g.referrer,sessid:null,viewid:null,sid:i.sid,uid:i.uid,tz:i.tz,geoid:i.geoid,cn:i.cn,rg:i.rg,ct:i.ct,dbi:i.dbi,tis:i.tis};function v(t,e){try{var i,n=0,o=t.length;if(void 0===o||"function"==typeof t){for(i in t)if(!1===e.call(t[i],i,t[i]))break}else for(;n<o&&!1!==e.call(t[n],n,t[n++]););}catch(t){}return t}var n,m=function(){function t(){this.script=function(t,e,i){var n=g.createElement("script");n.src=t+"?"+this.query(),n.onload=function(){"function"==typeof e&&e(),void 0!==i&&n.parentNode.removeChild(n)},g.getElementsByTagName("head")[0].appendChild(n)},this.dct={},this.k=[]}return t.prototype.put=function(t,e){return this.dct[t]=e,-1==this.k.indexOf(t)&&this.k.push(t),this},t.prototype.get=function(t){return this.dct[t]},t.prototype.remove=function(t){var e=this.k.indexOf(t);return-1!=e&&(this.k.splice(e,1),delete this.dct[t]),this},t.prototype.clear=function(){this.dct={},this.k=[]},t.prototype.size=function(){return this.k.length},t.prototype.query=function(){var t=[];for(var e in this.dct)this.dct.hasOwnProperty(e)&&t.push(encodeURIComponent(e)+"="+encodeURIComponent(this.dct[e]));return t.join("&")},t.prototype.send=function(t,e){var i=new Image(1,1);if(i.src=t+"?"+this.query(),"function"==typeof e)if(i.complete)e();else{var n=!1;i.addEventListener("load",function(){!0!==n&&e(),n=!0}),setTimeout(function(){!0!==n&&(e(),n=!0)},1e3)}},t}(),o=function(){function t(){this.timer=0,this.iInstance=void 0,this.start(),this.isPaused=!1}return t.prototype.start=function(){if(this.isPaused=!1,void 0===this.iInstance){var t=this;this.iInstance=h.setInterval(function(){t.timer+=1},1e3)}},t.prototype.stop=function(){void 0!==this.iInstance&&(this.isPaused=!0,h.clearInterval(this.iInstance),this.iInstance=void 0)},t.prototype.reset=function(){this.timer=0},t.prototype.get=function(){return this.timer},t.prototype.paused=function(){return this.isPaused},t}(),t=function(){function t(){this.start=+new Date,this.data={hbt:0,click:[],mouse:[],scroll:[]}}return t.prototype.startSession=function(){this.start=+new Date},t.prototype.click=function(t,e){if(this.data.click.length<3){var i=+new Date-this.start;this.data.click.push([i,t,e].join("."))}},t.prototype.mouse=function(t,e){if(this.data.mouse.length<3){var i=+new Date-this.start;this.data.mouse.push([i,t,e].join("."))}},t.prototype.scroll=function(t){if(this.data.scroll.length<3){var e=+new Date-this.start;this.data.scroll.push([e,t].join("."))}},t.prototype.clean=function(){this.data.click=[],this.data.mouse=[],this.data.scroll=[]},t}(),e=function(){function t(){this.mousePos={x:void 0,y:void 0,target:void 0},this.oldX=-1,this.oldY=-1,this.oldTarget=void 0,this.scrollPos=-1,this.pageYOffset=-1,this.timer=void 0,this.idleTimer=void 0}return t.prototype.isCorrectUrl=function(){if("infinite-scroll"==l.appType||u(l.appType)){var t=h.location.pathname.toLowerCase();return l.path.length-t.length<=1&&-1<l.path.indexOf(t)}return!0},t.prototype.registerMouseMove=function(t){var e=(t=t||h.event).target||t.srcElement;self.mousePos={x:t.clientX,y:t.clientY,target:e},this.notifyActive()},t.prototype.registerClick=function(){s.click(self.mousePos.x,self.mousePos.y),this.notifyActive()},t.prototype.registerBlur=function(){this.notifyInactive()},t.prototype.registerFocus=function(){this.notifyActive()},t.prototype.notifyActive=function(){this.isCorrectUrl()&&(this.timer.start(),this.idleTimer.reset())},t.prototype.notifyInactive=function(){this.timer.stop()},t.prototype.checkMousePosition=function(){var t=self.mousePos;t&&(t.x==self.oldX&&t.y==self.oldY||(self.oldX=t.x,self.oldY=t.y,s.mouse(t.x,t.y),this.notifyActive()))},t.prototype.checkScrollPosition=function(){var t=g.body.scrollTop;0===t&&(t=self.pageYOffset?self.pageYOffset:g.body.parentElement?g.body.parentElement.scrollTop:0),self.scrollPos!=t&&(self.scrollPos=t,s.scroll(self.scrollPos),this.notifyActive())},t}(),r=function(){var d="body",a="scrollHeight",u="offsetHeight",c="clientHeight",f="documentElement";function p(t){if(!t||!t.getBoundingClientRect)return{t:0,l:0};var e=t.getBoundingClientRect(),i="scrollTop",n="scrollLeft",o="clientTop",r="clientLeft",s=h.pageYOffset||g[f][i]||g[d][i],a=h.pageXOffset||g[f][n]||g[d][n],u=g[f][o]||g[d][o]||0,c=g[f][r]||g[d][r]||0,p=e.top+s-u,l=e.left+a-c;return{t:Math.round(p),l:Math.round(l)}}return{rimg:function(){return{trigger:function(t){var e,i,n,o,r=new m,s=(e=g.getElementById("pressboard-ad-sponsorship-footer"+l.tis)||g.getElementById(w+l.tis)||h.pressboardMedia.footerElm,i=p(g.getElementById(b+l.tis)),n=p(e),o={t:n.t+(e?e.clientHeight:0),l:n.l},{pbs:[i.t,i.l].join("."),pbm:[n.t,n.l].join("."),pbl:[o.t,o.l].join(".")});r.put("mid",l.mid),r.put("cid",l.cid),r.put("sid",l.sid),r.put("rand",(new Date).getTime().toString()),v(t,function(t,e){r.put(t,e)}),v(s,function(t,e){r.put(t,e)}),r.put("url",l.url),r.put("sessid",l.sessid),r.put("viewid",l.viewid),r.put("wh",function(){var t="getElementsByTagName",e=g[t]("html")[0],i=g[t]("body")[0],n=e.style.height,o=i.style.height;e.style.height="auto",i.style.height="auto";var r=Math.max(g[d][a]||0,g[f][a]||0,g[d][u]||0,g[f][u]||0,g[d][c]||0,g[f][c]||0);return e.style.height=n,i.style.height=o,r}().toString()),r.put("vh",Math.max(g[f][c],h.innerHeight||0).toString()),r.put("referrer",l.referrer),r.put("uid",l.uid),r.put("tz",l.tz),r.put("geoid",l.geoid),r.put("cn",l.cn),r.put("rg",l.rg),r.put("ct",l.ct),r.put("dbi",l.dbi),r.send(y+"/track/attention-px",void 0)}}}}}(),s=new t,a=(n=new e,{init_session_timer:function(){s.startSession(),h.onblur=function(){n.registerBlur()},h.onfocus=function(){n.registerFocus()},n.timer=new o,n.idleTimer=new o;var t=this,e=h.setInterval(function(){if(n.timer.paused()||(s.data.hbt=n.timer.get()),h.ncaTimer=n.timer.get(),!n.isCorrectUrl()&&(n.notifyInactive(),u(l.appType)))return delete T.stories[l.sKey],h.clearInterval(e);20<=n.idleTimer.get()&&n.notifyInactive(),n.timer.paused()||(t.engine.trigger({clk:s.data.click.join("-"),mus:s.data.mouse.join("-"),scrl:s.data.scroll.join("-"),hbt:s.data.hbt.toString()}),s.clean())},i.intervalTime)},init_mouse_events:function(){h.onmousemove=function(t){n.registerMouseMove(t)},h.onmouseup=function(){n.registerClick()},h.setInterval(function(){n.checkMousePosition()},300),h.setInterval(function(){n.checkScrollPosition()},300)},init:function(){var t=S()?null:C();this.engine=r.rimg(),this.init_mouse_events(),i.isInEu?l.sessid=(new Date).getTime().toString():(l.sessid=null===I("__psid")?(new Date).getTime().toString():I("__psid"),k("__psid",l.sessid,0,"/",t,!1)),l.viewid=(new Date).getTime().toString(),this.init_session_timer()}});(h.page=a).init()}d.pressboardMedia||(d.pressboardMedia={stories:{}},d.top!=d.self&&(d.top.pressboardMedia=d.pressboardMedia));var T=d.pressboardMedia,i=null,I=function(t){for(var e=t+"=",i=a.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return null},k=function(t,e,i,n,o,r){var s=new Date;s.setTime(s.getTime()+i),a.cookie=t+"="+encodeURI(e)+(i?"; expires="+s.toUTCString():"")+(n?"; path="+n:"")+(o?"; domain="+o:"")+(r&&!0===r?"; secure":"")},C=function(){var t=location.host,e=t.split(".");return"www"!=e[0]?t:e.slice(1).join(".")},S=function(){return location.protocol+"//"+C()==y},u=function(t){return"single-page"==t},e=function(){function t(){this.eventQueue=[[]]}return t.prototype.trim=function(t){return"function"!=typeof String.prototype.trim?t.toLowerCase().replace(/^\s+|\s+$/g,""):t.toLowerCase().trim()},t.prototype.queueEvent=function(t,e,i){var n=this;t=n.trim(t),e&&(e=n.trim(e)),"single-page"!=e&&"infinite-scroll"!=e&&"sand-boxed"!=e&&(e="classic"),i=i||{},n.eventQueue[n.eventQueue.length-1].push({event:[t,e,i]}),setTimeout(function(){n.sendEvents()},0)},t.prototype.addFlushPoint=function(){0!==this.eventQueue[this.eventQueue.length-1].length&&this.eventQueue.push([])},t.prototype.sendEvents=function(){var t=this;if(f+=1,0!==t.eventQueue[0].length){var e=t.eventQueue.shift();0===t.eventQueue.length&&t.eventQueue.push([]);for(var i=0;i<e.length;i++){var n=e[i].event[0],o=e[i].event[1],r=T.pbCfg?T.pbCfg:e[i].event[2],s=y+"/"+f,a=S()?s:d.location.href,u=S()?s:d.location.pathname;if(u&&!T.stories.hasOwnProperty(u))if(T.stories[u]=1,T.pbCfg)t.initStory(u,a,T.pbCfg,o);else if(r&&r.cookieAge){var c="_pressboardmedia_id",p=I(c);if(null==p&&(p=r.uid?r.uid:"",-1!=r.cookieAge&&""!=p)){var l=S()?null:C();k(c,p,r.cookieAge,"/",l,!1)}r.uid=p,r.mid=n,T.pbCfg=r,t.initStory(u,a,r,o)}}}},t.prototype.initStory=function(e,i,n,o){var r=this,t=y+"/track/attention-data?media="+n.mid+"&ref="+encodeURIComponent(i);r.loadCfg(t,function(t){t.mid=n.mid,t.appType=o,t.uid=n.uid,t.isInEu=!!n.geo&&n.geo.IsInEu,t.geoid=n.geo?n.geo.GeoNameId:"",t.cn=n.geo?n.geo.Country:"",t.rg=n.geo?n.geo.Region:"",t.ct=n.geo?n.geo.City:"",t.tis="",t.sKey=e,t.intervalTime=1e3,r.trackStory(i,t)})},t.prototype.trackStory=function(t,e){if(e&&e.sid){e.tis="_"+e.sid;var i=y+"/s/pb_sponsorship?media="+e.mid+"&ref="+encodeURIComponent(t)+"&uid="+encodeURIComponent(e.uid)+"&cn="+e.cn+"&tis="+e.tis;this.loadSponsorship(i)}else e.intervalTime=1e4,this.randomizePbTags();e.intervalTime<1e4&&(n===a?o(d,a,e):o(d.top,n,e))},t.prototype.randomizePbTags=function(){var t="_"+Math.random().toString(),e=a.getElementById(b),i=a.getElementById(w);e&&(e.id+=t),i&&(i.id+=t)},t.prototype.loadSponsorship=function(t){i&&i.parentNode.removeChild(i),i=this.buildScript(a,t);var e=a.getElementsByTagName("script")[0];e.parentNode.insertBefore(i,e)},t.prototype.loadCfg=function(t,e){var i=new XMLHttpRequest,n={};i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){try{n=JSON.parse(i.responseText)}catch(t){}e(n)}},i.open("GET",t,!0),i.send()},t.prototype.buildScript=function(t,e){var i=t.createElement("script");return i.type="text/javascript",i.async=!0,i.src=e,i},t}();return function(){if(window.pbinit){var o=new e;window.pbinit.exe=function(){var t,e=Array.prototype.slice.call(arguments),i=e[0],n=e.slice(1);switch(i){case"init":t=o.queueEvent;break;case"new_event":t=o.addFlushPoint}"function"==typeof t&&t.apply(o,n)};for(var t=0;t<window.pbinit.queue.length;t++)window.pbinit.exe.apply(null,window.pbinit.queue[t])}}()}();